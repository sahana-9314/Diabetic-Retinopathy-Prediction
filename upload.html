<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nayan- your health buddy</title>
    <link rel="stylesheet" href="style1.css">
</head>
<body class="align">
    <h1 >Please Upload Image</h1>
    <!-- <p id="results" style="color: white;"></p> -->
    <div class="grid">

        <form name="imageUploadForm" onsubmit="uploadImage();return false;" method="POST" class="form login">
    
          <div class="form__field">
            <label for="image">
                <!-- <svg class="icon"></svg> -->
                <span class="hidden">Upload Retinal Image</span>Upload Retinal Image</label>
            <br>
            <input id="image" type="file" name="select_image" class="form__input" placeholder="Upload Retinal Image" required>
          </div>
    
          <div class="form__field">
            <input type="submit" value="View Results" >
          </div>
          
        </form>
        
    </div>
    <h2 id="results" style="color: white;"></h2>
    <a href="asanas.html" style="color: white;">Suggested Yoga Asanas</a>
    <script>

        let image = document.forms['imageUploadForm']['select_image']; //fetched the input element and have stored in image variable.
        let allowedMimes = ['png', 'jpg', 'jpeg']; //allowed image mime types
        let maxMb = 2; //maximum allowed size (MB) of image

        let flag = 0;
        function uploadImage() {
            if (!image.value) { // if the image input does not have value
                return showError('No image selected :(');
            }
            else {
                let mime = image.value.split('.').pop(); // get the extension/mime of image file
                if (!allowedMimes.includes(mime)) {  // if allowedMimes array does not have the extension
                    return showError("Only png,jpg,jpeg alowed");
                }
                else {
                    let kb = image.files[0].size / 1024; // convert the file size into byte to kb
                    let mb = kb / 1024; // convert kb to mb
                    if (mb > maxMb) { // if the file size is gratter than maxMb
                        return showError(`Image should be less than ${maxMb} MB`);
                    }
                    else { // if all the validations are good
                        alert("Image has uploaded successfully :)")
                        flag=1;
                        const results = [0, 1, 2, 3, 4]
                        let ans = results[Math.floor(Math.random()*results.length)]

                        const list = ["No DR", 'Mild DR', 'Moderate DR', 'Severe DR', 'Proliferate DR']

                        document.getElementById("results").innerHTML = `The image you have uploaded has ${list[ans]}`;
                        // document.getElementById("results").innerHTML = list[ans];
                        console.log(list[ans])
                        //alert(`The image you have uploaded has ${list[ans]}`);
                        
                    }
                }
            }

            

        }

        function viewresults() {
            if(flag == 1) {
                const results = [0, 1, 2, 3, 4]
                let ans = results[Math.floor(Math.random()*results.length)]

                const list = ["No Dr", 'Mild', 'Moderate', 'Severe', 'Proliferate']

                // document.getElementById("results").innerHTML = `The image you have uploaded has ${list[ans]}`;
                document.getElementById("results").innerHTML = list[ans];
                alert(`The image you have uploaded has ${list[ans]}`);
                console.log(list[ans])
            }
        }

        function showError(errorMessage) {
            alert(errorMessage);
        }

    </script>
    
</body>
</html>